'use strict';define(['common/pointerevents/pointerevents'],function(a){function b(a,b){var c,d,e=Math.round,f=Math.sqrt;b?(c=e(f(-1*a.subcontainer.offsetLeft/a.container.clientWidth)*a.duration),d=0):(c=e(f((a.container.offsetWidth+a.subcontainer.offsetLeft)/a.container.clientWidth)*a.duration),d='-100%'),0<c?(a.sliding=!0,a.subcontainer.style[p]='left '+c+'ms ease-in-out',a.subcontainer.style.left=d):i(a)}function c(a,b){if(a.target===this){for(b.invisible.appendChild('-100%'===this.style.left?this.firstChild:this.lastChild),this.style[p]='',this.style.left=0,b.sliding=!1;0<b.removeStack.length;)b.remove(b.removeStack.shift());for(;0<b.pushStack.length;)b.add(b.pushStack.shift());k(b,'slidend'),i(b)}}function d(a,b,c,d){if('start'!==a.type)(b.moving||d.sl)&&('move'===a.type?e(a,b,d):'end'===a.type?f(a,b,d):g(b,d));else if(!c.pointers.length&&1<b.children.length&&!b.sliding)return b.timer&&(clearTimeout(b.timer),delete b.timer),d.ox=d.nx=d.x=a.x,d.ot=d.nt=a.domEvent.timeStamp,d.sl=function(){document.removeEventListener('scroll',d.sl,!0),delete d.sl},document.addEventListener('scroll',d.sl,!0),!0}function e(a,b,c){var d,e,f;1<b.children.length&&!b.sliding&&(c.ox=c.nx,c.ot=c.nt,c.nx=a.x,c.nt=a.domEvent.timeStamp,!b.moving&&Math.abs(c.nx-c.x)>b.minVal&&(b.moving=!0,c.sl()),b.moving&&(d=c.nx-c.x,e=c.nx>c.x?Math.floor(d/b.container.clientWidth):Math.ceil(d/b.container.clientWidth),d%=b.container.clientWidth,0===e?e=b.current:(c.x+=e*b.container.clientWidth,e=j(b.current-e,b.children.length)),f=0===d?e:j(0<d?e-1:e+1,b.children.length),b.children[e]!==b.subcontainer.firstChild&&b.children[f]!==b.subcontainer.firstChild&&b.invisible.appendChild(b.subcontainer.firstChild),b.subcontainer.lastChild&&b.children[e]!==b.subcontainer.lastChild&&b.children[f]!==b.subcontainer.lastChild&&b.invisible.appendChild(b.subcontainer.lastChild),b.children[e].parentNode!==b.subcontainer&&(0<b.subcontainer.childNodes.length&&0>d?b.subcontainer.insertBefore(b.children[e],b.children[f]):b.subcontainer.appendChild(b.children[e])),0<d?(b.subcontainer.firstChild!==b.children[f]&&b.subcontainer.insertBefore(b.children[f],b.children[e]),b.subcontainer.style.left=d-b.container.clientWidth+'px'):0>d?(b.subcontainer.lastChild!==b.children[f]&&b.subcontainer.appendChild(b.children[f]),b.subcontainer.style.left=d+'px'):b.subcontainer.style.left=0,e!==b.current&&(b.current=e,k(b,'change',{current:!0})))),b.moving&&(a.domEvent.preventDefault(),a.domEvent.stopPropagation())}function f(a,c,d){var e,f;2===c.subcontainer.childNodes.length?(e=(a.x-d.ox)/(a.domEvent.timeStamp-d.ot),f=Math.pow(e,2)*c.rate,0>e&&(f*=-1),c.children[c.current]===c.subcontainer.firstChild?c.subcontainer.offsetLeft+f<-0.5*c.container.offsetWidth?(b(c,!1),c.current=j(c.current+1,c.children.length),k(c,'change',{current:!0})):b(c,!0):c.subcontainer.offsetLeft+f>-0.5*c.container.offsetWidth?(b(c,!0),c.current=j(c.current-1,c.children.length),k(c,'change',{current:!0})):b(c,!1)):i(c),h(c,d)}function g(a,c){2===a.subcontainer.childNodes.length?b(a,a.children[a.current]===a.subcontainer.firstChild):i(a),h(a,c)}function h(a,b){a.moving?a.moving=!1:b.sl&&b.sl()}function j(a,b){var c=a%b;return 0>c&&(c+=b),c}function k(a,b,c){var d='on'+b;if('function'==typeof a[d])a[d]({type:b,__proto__:c})}function l(a){a.preventDefault()}function i(a){a.delay&&(a.timer=setTimeout(function(){delete a.timer,a.slideTo(a.current+1,1)},a.delay))}function m(a){a.target===this&&(this.scrollLeft=this.scrollTop=0)}var n,o,p;return'transition'in document.documentElement.style?(p='transition',o='transitionend'):(p='webkitTransition',o='webkitTransitionEnd'),n=function touchslider(b,e,f){function g(a){return d(a,k,i,p)}function h(a){k.sliding&&(a.preventDefault(),a.stopPropagation())}if(this instanceof n){var j,i,k=this,p={};if(this.pushStack=[],this.removeStack=[],b?(this.container=b,'static'===getComputedStyle(b).position&&(b.style.position='relative')):(this.container=document.createElement('div'),this.container.style.position='relative'),this.container.style.overflow='hidden',this.container.style.userSelect='none',this.invisible=this.container.appendChild(document.createElement('div')),this.invisible.style.position='absolute',this.invisible.style.visibility='hidden',this.subcontainer=this.container.appendChild(document.createElement('div')),this.subcontainer.style.position='absolute',this.subcontainer.style.width='200%',this.subcontainer.style.height='100%',this.subcontainer.style.left=this.subcontainer.style.top=0,this.subcontainer.addEventListener(o,function(a){c.call(this,a,k)},!1),this.container.addEventListener('dragstart',l,!1),this.container.addEventListener('scroll',m,!1),this.container.addEventListener('click',h,!0),i=a(this.container,g),e instanceof Array&&0<e.length)for(this.children=e,this.current='number'==typeof f&&0<=f&&f<e.length?f:0,j=0;j<e.length;j++)e[j].style.width='50%',e[j].style.height='100%',e[j].style.display='inline-block',j===this.current?this.subcontainer.appendChild(e[j]):this.invisible.appendChild(e[j]);else this.current=void 0,this.children=[]}else return new n(b)},n.prototype.rate=4e3,n.prototype.duration=400,n.prototype.minVal=5,n.prototype.add=function(a){var b;return this.sliding?this.pushStack.push(a):(b=this.children.length,a.style.width='50%',a.style.height='100%',a.style.display='inline-block',a.style.verticalAlign='top',this.children.push(a),b?(2===this.subcontainer.childNodes.length?this.current===b-1&&this.subcontainer.firstChild===this.children[this.current]?(this.invisible.appendChild(this.subcontainer.firstChild),this.subcontainer.insertBefore(a,this.subcontainer.lastChild)):0===this.current&&this.subcontainer.lastChild===this.children[this.current]?(this.invisible.appendChild(this.subcontainer.lastChild),this.subcontainer.appendChild(a)):this.invisible.appendChild(a):this.invisible.appendChild(a),k(this,'change',{length:!0})):(this.subcontainer.appendChild(a),this.current=0,k(this,'change',{current:!0,length:!0}))),b},n.prototype.remove=function(a){var b;return this.sliding?('number'==typeof a&&(a=this.children[a]),0>this.removeStack.indexOf(a)&&this.removeStack.push(a)):0<this.children.length&&('number'!=typeof a&&(a=this.children.indexOf(a)),a=j(a,this.children.length),b=this.children.splice(a,1)[0],this.current===a?(2===this.subcontainer.childNodes.length?1<this.children.length?b===this.subcontainer.firstChild?(this.current=j(a-1,this.children.length),this.subcontainer.insertBefore(this.children[this.current],b)):(this.current=j(a,this.children.length),this.subcontainer.appendChild(this.children[this.current])):(this.current=0,this.subcontainer.style.left=0):0<this.children.length?(this.current=j(a,this.children.length),this.subcontainer.appendChild(this.children[this.current])):this.current=void 0,this.subcontainer.removeChild(b),k(this,'change',{current:!0,length:!0})):(b.parentNode===this.subcontainer?(1<this.children.length?b===this.subcontainer.firstChild?this.subcontainer.insertBefore(this.children[j(a-1,this.children.length)],b):this.subcontainer.appendChild(this.children[j(a,this.children.length)]):(this.subcontainer.removeChild(b),this.subcontainer.style.left=0),this.subcontainer.removeChild(b)):this.invisible.removeChild(b),this.current>a?(this.current-=1,k(this,'change',{current:!0,length:!0})):k(this,'change',{length:!0}))),b},n.prototype.clear=function(){if(this.sliding)this.removeStack=this.children.slice(0),this.pushStack=[];else for(;this.children.length;)this.remove(0)},n.prototype.slideTo=function(a,c){var d;return'number'!=typeof a&&(a=this.children.indexOf(a)),a=j(a,this.children.length),d=!this.sliding&&a!==this.current,d&&(0<c?(this.subcontainer.appendChild(this.children[a]),b(this,!1)):0>c?(this.subcontainer.insertBefore(this.children[a],this.children[this.current]),this.subcontainer.style.left='-100%',b(this,!0)):(this.invisible.appendChild(this.children[this.current]),this.subcontainer.appendChild(this.children[a])),this.current=a,k(this,'change',{current:!0})),d},n.prototype.startPlay=function(a){this.stopPlay(),this.delay=a,i(this)},n.prototype.stopPlay=function(){var a=this.delay;return a&&(delete this.delay,this.timer&&(clearTimeout(this.timer),delete this.timer)),a},n});